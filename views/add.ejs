<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="/stylesheets/style.css" />
  </head>

  <body>
    <h1>Add New Sighting!</h1>
    <form action="/sightings" method="POST">
      <label for="userNickName">Username:</label>
      <input type="text" id="userNickname" name="userNickname" required />
      <label for="image">Image:</label>
      <input
        type="file"
        id="image"
        name="image"
        accept="image/*"
        onchange="loadFile(this)"
      />
      <label for="date">Date/Time:</label>
      <input type="datetime-local" id="date" name="date" required />
      <label for="description">Description:</label>
      <input type="text" id="description" name="description" required/>
      <label for="latitude">Latitude:</label>
      <input type="text" id="latitude" name="latitude" required readonly />
      <label for="longitude">Longitude:</label>
      <input type="text" id="longitude" name="longitude" required readonly />
      <button type="button" id="locationButton">Get Location</button>
      <input type="submit" />
    </form>
    <% if (typeof error != "undefined") { %>
     <p>There was an error submitting your sighting: 
        <br><%= error %></p>
    <% } %>%>
  </body>
  <script type="text/javascript">
    var btn = document.getElementById("locationButton");
    var longitude = document.getElementById("longitude");
    var latitude = document.getElementById("latitude");

    btn.addEventListener("click", getLocation);

    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
      } else {
        alert("Geolocation is not supported by this browser.");
      }
    }
    function showPosition(position) {
      latitude.value = position.coords.latitude;
      longitude.value = position.coords.longitude;
    }

    function loadFile(event) {
      // TODO: Add image upload and preview
    }
  </script>
</html>
